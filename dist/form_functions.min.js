/*
 *  Form-Functions - v1.2.1
 *  Help functions for processing form errors
 *  http://highgate-creative.com
 *
 *  Made by 
 *  Sean Zellmer <sean@lejeunerenard.com>
 *  Bradford Cathey <bradc@highgate-creative.com>
 *  Under MIT License
 */
!function(a,b,c){function d(a,b){var d={};"undefined"!=typeof b?(d.element=a,d.prefix=b):a&&(d.element=a),c(".errors_above").css("display","none");var e;e=c(d.element?"#"+c(d.element).attr("id")+" label[for]":"label[for]"),e.not(".static_label").each(function(){c(this).removeClass("error_label");var a=h(this,d);0!==c('label.static_label[for="'+c(this).attr("for")+'"]').length&&(a=""),c(this).text(a)})}function e(a){"string"==typeof a&&"["===a[0]&&(a=JSON.parse(a)),"string"==typeof a&&a.match(/.+\[\{"messages/)?a=JSON.parse(a.replace(/.+\[\{"messages/,'[{"messages').replace("</pre>","")):"string"==typeof a&&(a=JSON.parse(c(a).text()));var b;return b=a instanceof Array?a[0].messages:a.errors?a.errors:a.success}function f(a){this.msgdiv=c("#"+a.msgdiv),this.prependMsg=a.prependMsg}function g(b,d,g,i,j,k){var l={overlay:!0,showSuccessMsg:!0,prependMsg:!1,form:c("form").first(),scrollToError:!1};"undefined"!=typeof d?(l.result=b,l.form=d,l.msgdiv=g,l.leave_open=i,l.not_reset_form=j,l.prefix=k):l=c.extend({},l,b);var m=new f(l);l.overlay&&c("#overlay").css("display","none"),m.msgdiv.find("p.error").remove();var n,o="";if(n=l.form instanceof c?l.form:c("#"+l.form),c.each(e(l.result),function(a,b){for(var d in b){var e=b[d];if("success"===d)e instanceof Array?c.each(e,function(a,b){o+=c("<textarea />").html('<p class="success">'+b+"</p>").text()}):o+=c("<textarea />").html('<p class="success">'+e+"</p>").text();else if("su_"===d.substring(0,3))c(c("label[for='"+d.substring(3)+"']")).not(".static_label").each(function(){c(this).addClass("success_label"),c(this).html(h(this,l)+" "+e)}),c(".errors_above").css("display","block"),("captcha"===d||"generic"===d)&&m.addGenericError(e);else{if("output"===d)return;if(d=d.replace("&#228;","ä"),d=d.replace("&#196;","Ä"),d=d.replace("&#246;","ö"),d=d.replace("&#214;","Ö"),d=d.replace("&#252;","ü"),d=d.replace("&#220;","Ü"),d=d.replace("&#223;","ß"),"captcha"===d||"generic"===d)m.addGenericError(e);else{var f=n.find("label[for='"+d+"']").not(".static_label");if(f.each(function(){c(this).addClass("error_label"),c(this).html(h(this,l)+" "+e)}),f.length<=0){var g=d.replace(/_/," ");l.capitalize&&(g=g.slice(0,1).toUpperCase()+g.slice(1)),m.addGenericError(g+" "+e)}}c(".errors_above").css("display","block")}}}),o)l.leave_open||n.hide("fast"),l.not_reset_form||n.get(0).reset(),l.showSuccessMsg&&(m.msgdiv.css("display","block"),m.msgdiv.find("p").css("display","block"),m.msgdiv.find("p.error").css("display","none"),m.addGenericMessage(o),m.msgdiv.offset().top<c(a).scrollTop()&&c("html, body").animate({scrollTop:m.msgdiv.offset().top},"fast")),"function"==typeof l.success&&l.success(l.result),"undefined"!=typeof redirect_set&&redirect_set?redirect():"function"==typeof l.redirect&&l.redirect();else{if(l.scrollToError){var p=m.msgdiv.find(".error");0===p.length&&(p=n.find(".error_label, .error")),c("html, body").animate({scrollTop:p.offset().top},"fast")}"function"==typeof l.error&&l.error(l.result)}}function h(a,b){var d=c(a).data("lab")||c(a).attr("lab")||c(a).attr("for");return b.prefix&&(d=d.replace(b.prefix,"")),b.capitalize&&(d=d.slice(0,1).toUpperCase()+d.slice(1)),d=d.replace(/_/g," "),c(a).data("lab")||c(a).data("lab",d),d}function i(b,c,d,e){var f=a.getElementById(d).value,g=f.length;return a.getElementById("counter"+b).value=e?c-g:g,g>c?(a.getElementById("counter"+b).style.background="pink",alert("Please keep your answers within "+c+" characters. And please, no pasting of any word processing files. Thank you."),!1):void(a.getElementById("counter"+b).style.background="#fff")}function j(a){namount=Math.abs(a),namount=parseInt(100*(namount+.005)),namount/=100;var b=String(namount);return b.indexOf(".")<0&&(b+=".00"),b.indexOf(".")===b.length-2&&(b+="0"),b}f.prototype.addGenericMessage=function(a){this.msgdiv.css("display","block"),this.prependMsg?this.msgdiv.prepend(a):this.msgdiv.append(a)},f.prototype.addGenericError=function(a){this.addGenericMessage('<p class="error">'+a+"</p>")},c(function(){c(a).on("keyup","textarea.counter",function(){var a=c(this).val(),b=a.length;return c(this).siblings("input.counter").val(c(this).hasClass("count_down")?c(this).attr("size")-b:b),b>c(this).attr("size")?(c(this).siblings("input.counter").css("background","pink"),alert("Please keep your answers within "+c(this).attr("size")+" characters. And please, no pasting of any word processing files. Thank you."),!1):void c(this).siblings("input.counter").css("background","#fff")})}),b.normalize_labels=d,b.parse_results=g,b.counter=i,b.format_currency=j,b.FormFunctions=f}(document,window,jQuery);